<?xml version="1.0" encoding="utf-8"?>
<program xmlns="http://www.kinoma.com/kpr/1">
    
    <skin id="color1" color="#495241" />
    <skin id="color2" color="#B8AE9C" />
    <skin id="color3" color="#8A0917" />
    <skin id="color4" color="#ACCFCC" />
    <skin id="white" color="white" />
    
    <style id="title" font="bold 25px" color="white" align="left,top"/>
    <style id="title2" font="bold 40px" color="#8A0917" align="left,top"/>
    <style id="sensor" font="25px" color="black" align="left,top"/>
    
    <script>
    	var numSensor = 0;
    	var txtList = [];
    	var imgList = [];
    </script>
    
	<handler path="/updatePic">
		<behavior>
			<method id="onInvoke" params="container, message"><![CDATA[
				var reading = message.requestObject;
				var lightNum = 0; //0 for now but this will need to be able to change in order to account for different lights
				if(reading < 0.5) //arbitrary number for now
				{
					imgList[lightNum] = new Picture({left:70, right:220, top:30 + 25 * 3, bottom:190 - 25 * 3, height:25, width:25}, "media/moon.jpeg");
				}
				else
				{
					imgList[lightNum] = new Picture({left:70, right:220, top:30 + 25 * lightNum, bottom:190 - 25 * lightNum, height:25, width:25}, "media/sun.jre");
				}
				application.add(imgList[0]);
			]]></method>
		</behavior>
	</handler> 
    
    <container id="body" left="0" top="0" right="0" bottom="0" skin="color1" active="true">
		<text left="0" right="0" top="0" bottom="0" style="title" string="$.text"/>
		<text  left="0" right="0" top="25" bottom="0" style="title" skin="color2" string=""/>
		
		<behavior>
		
			<method id="onLaunch" params="content"><![CDATA[
            var message = new MessageWithObject("pins:configure", {
                lightSensor: {
                    require: "lightSensor",
                    type: "A2D",
                    pins: {
                    lightSensor1: {pin:51}
                    }
                }});
            application.invoke(message);

            message = new MessageWithObject("pins:/lightSensor/read?repeat=on&callback=/updatePic&interval=750");
            application.invoke(message);
			]]></method>
		
			<method id="onCreate" params="container, data"><![CDATA[
				this.data = data;
				this.sound = new Sound( mergeURI( application.url, "media/Shutter-02.wav" ) );
				Sound.volume = 1000.0;
			]]></method>
				
			<method id="onTouchEnded" params="container, x, y, ticks">
                <![CDATA[
                   this.sound.play();
                   if(numSensor < 8){
	                   var nxtTxt = new Text({left:15, right:0, top:30 + 25 * numSensor, bottom:0}, color2, sensor, "Light " + (numSensor+1));
                       txtList.push(nxtTxt);
                       
                       var lightsOn = new Text({left:180, right:10, top:100, bottom:0}, color2, title2, "" + (numSensor + 1) + " Light(s) On");
                       
                       var nxtLight = new Picture({left:70, right:220, top:30 + 25 * numSensor, bottom:190 - 25 * numSensor, height:25, width:25}, "media/sun.jpe");
                       imgList.push(nxtLight);
                       
	                   container.add(nxtTxt);

	                   container.add(lightsOn);
	                   container.add(nxtLight);
	                   numSensor++;
	                   
	                   //This is where I will try playing the sounds from at a later time.  

	               }
	               else{
	                  container.remove(txtList[2]);
	                  imgList[3] = new Picture({left:70, right:220, top:30 + 25 * 3, bottom:190 - 25 * 3, height:25, width:25}, "media/moon.jpeg");
	                  container.add(imgList[3]);
	                  container.remove(imgList[2]);
	                  numSensor--;
	               }
                ]]>
            </method>
		</behavior>
	</container>
	
    <script>
        <![CDATA[
        	application.add( new body({text:"List of Lights"}) );
        ]]>
    </script>
</program>
